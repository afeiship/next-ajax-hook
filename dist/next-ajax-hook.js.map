{"version":3,"sources":["next-ajax-hook.js"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"next-ajax-hook.js","sourcesContent":["(function() {\n  var global = global || this || window || Function('return this')();\n  var nx = global.nx || require('next-js-core2');\n  var REAL_XHR = '__RealXMLHttpRequest__';\n  var DEFAULT_PROPXY = { properties: null, methods: null, events: null };\n\n  var NxAjaxHook = nx.declare('nx.AjaxHook', {\n    statics: {\n      __proxy: null,\n      __hookProperties: function(inXhr) {\n        var properties = this.proxy.properties;\n        nx.forIn(properties, function(key, value) {\n          nx.defineProperty(inXhr, key, value);\n        });\n      },\n      __hookMethods: function(inXhr) {\n        var methods = this.proxy.methods;\n        nx.forIn(methods, function(key, value) {\n          var old = inXhr[key].bind(inXhr);\n          inXhr[key] = function() {\n            var args = nx.slice(arguments);\n            if (value.call(inXhr, args, old) !== null) {\n              old.apply(inXhr, args);\n            }\n          };\n        });\n      },\n      __hookEvents: function(inXhr) {\n        var events = this.proxy.events;\n        nx.forIn(events, function(key, value) {\n          inXhr.addEventListener(key, value);\n        });\n      },\n      on: function(inProxy) {\n        var self = this;\n        this.proxy = nx.mix(null, DEFAULT_PROPXY, inProxy || this.__proxy);\n        global[REAL_XHR] = global[REAL_XHR] || global.XMLHttpRequest;\n\n        global.XMLHttpRequest = function() {\n          var xhr = new global[REAL_XHR]();\n          self.__hookProperties(xhr);\n          self.__hookMethods(xhr);\n          self.__hookEvents(xhr);\n          return xhr;\n        };\n      },\n      off: function() {\n        global[REAL_XHR] && (global.XMLHttpRequest = global[REAL_XHR]);\n      }\n    }\n  });\n\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = NxAjaxHook;\n  }\n})();\n"]}